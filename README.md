## 概要

このリポジトリは、Claude Code のSubagentsで「ドキュメント駆動のワークフロー」を回すための最小構成テンプレートです。アプリ実装コードは含めず、ワークフロー運用に必要なプロンプト設定と進捗ドキュメントのみを提供します。

## 特徴

 - **ワークフローループを自動運用**: 1 ステップ実装 → レビュー → ドキュメント更新 → 次の計画 を自動ループ
- **プロンプトと設定の分離**: `.claude/` 配下にシステムプロンプトとサブエージェントの最小設定を格納
- **ドキュメント駆動**: `docs/plan.md` をベースにアプリケーションの実装を行います。
- **進捗管理**: `docs/context.md` を単一の情報源として進捗・要件を管理

## ディレクトリ構成

```
claude-code-agents-workflow/
  ├─ .claude/
  │   ├─ agents/
  │   │   ├─ planner.md     # 計画担当エージェントのプロンプト
  │   │   ├─ executor.md    # 実装担当エージェントのプロンプト
  │   │   └─ reviewer.md    # レビュー担当エージェントのプロンプト
  │   ├─ commands/
  │   │   └─ wf.md          # /wf コマンドの仕様・ループ手順
  │   └─ settings.json      # セッション開始/完了での簡易メッセージ設定
  └─ docs/
      ├─ context.md         # 現在の実装状況・レビュー・決定事項のログ（進捗台帳）
      └─ plan.md            # 設計方針・UML・ユースケース等の計画書
```

## 使い方（Claude Code Subagents）

1. **タスクを投入**
   ```bash
   /wf <タスク内容>
   ```
   - 例: `/wf docs/plan.md に従って実装。テストはPlaywrightで実装する。`

2. **進捗確認**
   - エージェントは 1 ステップずつ実装 → レビュー → `docs/context.md` へ反映します。
   - 完了時は設定に従い完了メッセージが表示されます。

## ワークフローループの仕様

ワークフローでは次のループを自動反復します。

- 1. 次のステップを計画（planner）
- 2. 1ステップだけ実装（executor）
- 3. 実装をレビュー（reviewer）
- 4. 必須修正があれば修正 → 再レビュー
- 5. `docs/context.md` を更新（進捗・変更点・判定）
- 6. 完了判定。未完了なら 1 に戻る

重要原則:
- 1 回の実装 = 1 ステップのみ／各ステップ後に必ずレビュー／進捗は常に `docs/context.md` で管理

## ドキュメントの役割

- `docs/plan.md`: 要件・設計・UML・ユースケース・非機能要件などの「計画書」(実際にはこの仕様書を自分のアプリに合わせて作成したものを利用する)
- `docs/context.md`: 実装ステップ、レビュー結果、修正内容、最終判定などの「進捗台帳」

運用メモ:
- 新しい決定事項やレビュー所見は必ず `docs/context.md` に追記します。
- 設計変更は `docs/plan.md` を更新し、変更理由を簡潔に残します。

## カスタマイズ

- `.claude/settings.json`
  - セッション開始時やSubagents完了時のメッセージなど、軽微なフックを定義します。

## 補足: .claude ディレクトリの説明

- `.claude/agents/planner.md`
  - 役割: タスクを実装可能な小さなステップに分解し、順序立てて計画
  - 入力: タスク説明、前回の実装・レビュー結果
  - 出力: `docs/context.md` の計画セクション更新（ステップごとの作業・対象ファイル・完了チェック）
  - ルール: 1 ステップ = 明確な作業、実装時間目安 5 分以内、対象ファイル 1-2 個

- `.claude/agents/executor.md`
  - 役割: 計画に基づいて 1 ステップのみ実装し、結果を記録
  - 入力: `docs/context.md` の現在ステップ、実装内容
  - 出力: `docs/context.md` の実装結果（変更内容・変更ファイル・備考）
  - ルール: 計画外実装をしない、エラーは報告、テスト可能な実装を心がける

- `.claude/agents/reviewer.md`
  - 役割: 直前の実装をレビューし、問題点と改善提案を提示
  - 入力: 実装されたコード、`docs/context.md` の実装結果
  - 出力: `docs/context.md` のレビュー結果（良い点・改善点・判定）
  - 特記: 合格時は `git add -A` → `git commit` を自動実行（メッセージ規約付き）

- `.claude/commands/wf.md`
  - `/wf` コマンドの使い方と内部ループ仕様を定義（Planner → Executor → Reviewer を完了まで反復）
  - 重要仕様: 1 回の実装 = 1 ステップ、各ステップ後に必ずレビュー、`docs/context.md` で進捗管理

- `.claude/settings.json`
  - セッション開始時（SessionStart）とタスク完了時（PostToolUse）の簡易フック
  - 例: セッション開始時に `/wf <タスク>` の案内、タスク完了時に完了メッセージ出力

## よくある質問（FAQ）

- **Q. どこを編集すればワークフローが変わりますか？**  
  - プロンプトや運用ルールは `.claude/` 配下、要件や進捗は `docs/` 配下を編集してください。

- **Q. 以前の実装ログが長いのですが削除して良いですか？**
  - 必要に応じてサマリー化して構いません。意思決定の経緯は `docs/context.md` に短く残すと再現性が高まります。

## ライセンス

MIT License


